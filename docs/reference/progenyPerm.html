<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute progeny pathway scores and assesses significance based on permutations — progenyPerm • progeny</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute progeny pathway scores and assesses significance based on permutations — progenyPerm" />
<meta property="og:description" content="Compute progeny pathway scores and assesses significance based on permutations" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119440867-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-119440867-8');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">progeny</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/progenyBulk.html">PROGENy pathway signatures: Application to Bulk transcriptomics</a>
    </li>
    <li>
      <a href="../articles/ProgenySingleCell.html">Applying PROGENy on single-cell RNA-seq data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/saezlab/progeny/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/saezlab">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://www.saezlab.org">
    <span class="fas fa-university"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute progeny pathway scores and assesses significance based on permutations</h1>
    <small class="dont-index">Source: <a href='https://github.com/saezlab/progeny/blob/master/R/progenyPermutations.r'><code>R/progenyPermutations.r</code></a></small>
    <div class="hidden name"><code>progenyPerm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute progeny pathway scores and assesses significance based on permutations</p>
    </div>

    <pre class="usage"><span class='fu'>progenyPerm</span><span class='op'>(</span>
  <span class='va'>df</span>,
  <span class='va'>weight_matrix</span>,
  k <span class='op'>=</span> <span class='fl'>10000</span>,
  z_scores <span class='op'>=</span> <span class='cn'>TRUE</span>,
  get_nulldist <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>A data.frame of n*m+1 dimension, where n is the number of omic
features to be considered and m is the number of samples/contrasts.
The first column should be the identifiers of the omic features. 
These identifiers must be coherent with the identifiers of the weight matrix.</p></td>
    </tr>
    <tr>
      <th>weight_matrix</th>
      <td><p>A progeny coefficient matrix. the first column should be
the identifiers of the omic features and should be coherent with 
the identifiers provided in df.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>The number of permutations to be performed to generate
the null-distribution used to estimate the significance of progeny scores.  
The default value is 10000.</p></td>
    </tr>
    <tr>
      <th>z_scores</th>
      <td><p>if true, the z-scores will be returned for 
the pathway activity estimations. Else, the function returns 
a normalized z-score value between -1 and 1.</p></td>
    </tr>
    <tr>
      <th>get_nulldist</th>
      <td><p>if true, the null score distribution used for 
normalization will be returned along with the actual normalized score data 
frame.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>This function returns a list of two elements. The first element is 
a data frame of p*m+1 dimensions, where p is the number of progeny pathways,
and m is the number of samples/contrasts. Each cell represents the 
significance of a progeny pathway score for one sample/contrast. The 
significance ranges between -1 and 1. The significance is equal to x*2-1, x 
being the quantile of the progeny pathway score with respect to the null 
distribution. Thus, this significance can be interpreted as the equivalent of 
1-p.value two-sided test over an empirical distribution) with the sign 
indicating the direction of the regulation. The second element is the null 
distribution list (a null distribution is generated for each sample/contrast).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># use example gene expression matrix</span>
<span class='va'>gene_expression</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, 
<span class='st'>"human_input.csv"</span>, package <span class='op'>=</span> <span class='st'>"progeny"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># calculate pathway activities</span>
<span class='fu'><a href='progeny.html'>progeny</a></span><span class='op'>(</span><span class='va'>gene_expression</span>, scale<span class='op'>=</span><span class='cn'>TRUE</span>, organism<span class='op'>=</span><span class='st'>"Human"</span>, top<span class='op'>=</span><span class='fl'>100</span>, perm<span class='op'>=</span><span class='fl'>10000</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            Androgen   EGFR Estrogen Hypoxia JAK.STAT   MAPK    NFkB    p53
#&gt; SRR1039508  -0.8362 0.1964  -0.3524  0.9996   0.7756 0.4110 -0.5528 0.9310
#&gt; SRR1039509  -0.4944 0.0444  -0.6588  0.9996   0.4928 0.3220 -0.4226 0.8852
#&gt; SRR1039512  -0.7920 0.2006  -0.4054  0.9994   0.7016 0.4058 -0.4318 0.9166
#&gt; SRR1039513  -0.4322 0.0888  -0.6774  1.0000   0.6672 0.4530 -0.4654 0.7770
#&gt; SRR1039516  -0.7806 0.2562  -0.3104  0.9996   0.6286 0.4166 -0.3336 0.9198
#&gt; SRR1039517  -0.5116 0.5476  -0.6676  1.0000   0.4808 0.7268 -0.3894 0.8104
#&gt; SRR1039520  -0.8042 0.3280  -0.3976  0.9994   0.6168 0.5570 -0.6398 0.9012
#&gt; SRR1039521  -0.3400 0.1316  -0.6660  1.0000   0.4992 0.5676 -0.6298 0.7804
#&gt;               PI3K   TGFb    TNFa   Trail    VEGF     WNT
#&gt; SRR1039508  0.1656 0.5390 -0.5962 -0.3624  0.0566 -0.1118
#&gt; SRR1039509  0.0828 0.7702 -0.4380 -0.3110  0.0660 -0.1766
#&gt; SRR1039512  0.1604 0.6970 -0.4774 -0.3114  0.0546 -0.1698
#&gt; SRR1039513 -0.0630 0.8022 -0.4954 -0.2414  0.0772 -0.2848
#&gt; SRR1039516  0.1522 0.6836 -0.3830 -0.3382  0.2762 -0.3244
#&gt; SRR1039517  0.3704 0.8758 -0.4358 -0.3612  0.2562 -0.3990
#&gt; SRR1039520  0.1596 0.7016 -0.6738 -0.2768 -0.0808 -0.1116
#&gt; SRR1039521  0.0416 0.8198 -0.6466 -0.2534 -0.0634 -0.3198</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael Schubert, Aurélien Dugourd.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


